#!/usr/bin/env python3

from panflute import run_filter, stringify, Str, RawInline, Para


def action(elem, doc):
    acros = [stringify(ac['id']) for ac in doc.metadata["acronyms"]]

    txt = stringify(elem)

    if isinstance(elem, Str) and txt in acros and isinstance(elem.parent, Para):
        elem = RawInline("\\ac{" + txt + "}", format="latex")
        return elem


def main(doc=None):
    return run_filter(action,
                      doc=doc)


if __name__ == '__main__':
    main()
